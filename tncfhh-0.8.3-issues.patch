diff -urNp tncfhh-0.8.3/imcv/platid/imc/src/PlatidIMC.cpp tncfhh-0.8.3-cvs-patched/imcv/platid/imc/src/PlatidIMC.cpp
--- tncfhh-0.8.3/imcv/platid/imc/src/PlatidIMC.cpp	2011-08-29 07:17:52.000000000 -0400
+++ tncfhh-0.8.3-cvs-patched/imcv/platid/imc/src/PlatidIMC.cpp	2011-09-02 16:02:34.884916923 -0400
@@ -189,7 +189,7 @@ void PlatidIMC::processPrivateKeyLine(st
 
 void PlatidIMC::processCertificateFileLine(string line)
 {
-	int i;
+	unsigned int i;
 	i = line.find_first_of(' ');
 
 	if (i != line.npos) {
diff -urNp tncfhh-0.8.3/imunit/src/imunit/imc/IMCLibrary.cpp tncfhh-0.8.3-cvs-patched/imunit/src/imunit/imc/IMCLibrary.cpp
--- tncfhh-0.8.3/imunit/src/imunit/imc/IMCLibrary.cpp	2011-08-29 07:17:52.000000000 -0400
+++ tncfhh-0.8.3-cvs-patched/imunit/src/imunit/imc/IMCLibrary.cpp	2011-09-02 16:03:06.726866021 -0400
@@ -171,7 +171,10 @@ TNC_Result IMCLibrary::notifyConnectionC
 
 					// save IMC
 					imcInstances[connectionID] = tmp;
-					imc = getImcInstances(connectionID);
+					/* why to search  in the global list*/
+					/* if the list is long, it can cause performance issues*/
+					//imc = getImcInstances(connectionID);
+					imc = tmp;
 				}
 				break;
 			case TNC_CONNECTION_STATE_DELETE:
diff -urNp tncfhh-0.8.3/imunit/src/imunit/imv/IMVLibrary.cpp tncfhh-0.8.3-cvs-patched/imunit/src/imunit/imv/IMVLibrary.cpp
--- tncfhh-0.8.3/imunit/src/imunit/imv/IMVLibrary.cpp	2011-08-29 07:17:52.000000000 -0400
+++ tncfhh-0.8.3-cvs-patched/imunit/src/imunit/imv/IMVLibrary.cpp	2011-09-02 16:03:33.662823230 -0400
@@ -183,7 +183,10 @@ TNC_Result IMVLibrary::notifyConnectionC
 					if (!tmp) throw ResultException("createNewIMVInstance(..) return NULL", TNC_RESULT_FATAL);
 
 					imvInstances[connectionID] = tmp;
-					imv = getImvInstances(connectionID);
+					/* why to search  in the global list*/
+					/* if the list is long, it can cause performance issues*/
+					//imv = getImvInstances(connectionID);
+					imv=tmp;
 				}
 				break;
 				case TNC_CONNECTION_STATE_DELETE:
